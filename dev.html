<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<title>yolk generator</title>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:creator" content="@yolko0no" />
		<meta name="twitter:title" content="Home" />
		<meta
			name="twitter:image"
			content="https://brat.yolko0no.com/yolk.png"
		/>
		<meta name="twitter:image:alt" content="yolk" />
		<link rel="stylesheet" href="style.css" />
		<link
			rel="canonical"
			href="https://brat.yolko0no.com/dev"
		/>
		<!-- Fathom - beautiful, simple website analytics -->
		<script
			src="https://cdn.usefathom.com/script.js"
			data-site="ILBPHJZV"
			defer
		></script>
		<!-- / Fathom -->
	</head>
	<body class="deluxe">
		<input type="checkbox" name="color" id="switch" onclick="fathom.trackEvent('switch');" />
		<input type="file" onclick="fathom.trackEvent('upload');" />
		<fieldset>
			<input type="checkbox" name="green" id="green" />
			<label for="green"> make it green </label>
		</fieldset>
		<div class="image filter">
			<img class="output" />
			<div class="greenfilter"></div>
			<div class="text-output">
				<span class="text" contenteditable="true" spellcheck="false">
					yolk and it's the same but there's three more code so it's not
				</span>
			</div>
		</div>

		<script type="text/javascript">
			const fileInput = document.querySelector("input[type=file]");
			const output = document.querySelector(".output");
			const greenify = document.querySelector("input#green");
			const greenfilter = document.querySelector(".filter");
			const colorswitch = document.querySelector("input#switch");

			colorswitch.addEventListener("change", async () => {
				if (document.body.classList.contains("brat")) {
					document.body.classList.remove("brat");
					document.body.classList.add("deluxe");
					document.querySelector("label[for='green']").innerHTML =
						"make it grayscale";

					if (
						!document
							.querySelector("span.text")
							.classList.contains("changed")
					) {
						document.querySelector("span.text").innerHTML =
							"yolk and it's the same but there's three more code so it's not";

						resizeText({
							elements: document.querySelectorAll(".text"),
						});
					}
				} else {
					document.body.classList.remove("deluxe");
					document.body.classList.add("brat");
					document.querySelector("label[for='green']").innerHTML =
						"make it green";

					if (
						!document
							.querySelector("span.text")
							.classList.contains("changed")
					) {
						document.querySelector("span.text").innerHTML = "yolk";

						resizeText({
							elements: document.querySelectorAll(".text"),
						});
					}
				}
			});

			greenify.addEventListener("change", async () => {
				greenfilter.classList.toggle("visible");
			});

			fileInput.addEventListener("change", async () => {
				const [file] = fileInput.files;

				URL.revokeObjectURL(output.src);

				if (file) {
					output.src = URL.createObjectURL(file);
				}
			});
		</script>
		<script>
			const isOverflown = ({ clientHeight, scrollHeight }) =>
				scrollHeight > clientHeight;

			const resizeText = ({
				element,
				elements,
				minSize = 0,
				maxSize = 12,
				step = 0.01,
				unit = "vw",
			}) => {
				(elements || [element]).forEach((el) => {
					let i = minSize;
					let overflow = false;

					const parent = el.parentNode;

					while (!overflow && i < maxSize) {
						el.style.fontSize = `${i}${unit}`;
						overflow = isOverflown(parent);

						if (!overflow) i += step;
					}

					// revert to last state where no overflow happened
					el.style.fontSize = `${i - step}${unit}`;
				});
			};
			resizeText({
				elements: document.querySelectorAll(".text"),
			});
		</script>
		<script>
			function debounce(func) {
				var timer;
				return function (event) {
					if (timer) clearTimeout(timer);
					timer = setTimeout(func, 200, event);
				};
			}
			document
				.querySelector(".text")
				.addEventListener("blur", function (e) {
					document
						.querySelector("span.text")
						.classList.toggle("changed", true);

					resizeText({
						elements: document.querySelectorAll(".text"),
					});
				});
			window.addEventListener(
				"resize",
				debounce(function (e) {
					resizeText({
						elements: document.querySelectorAll(".text"),
					});
				})
			);
		</script>
		<script>
			document
				.querySelector("span[contenteditable]")
				.addEventListener("paste", function (e) {
					e.preventDefault();
					var text = e.clipboardData.getData("text/plain");
					document.execCommand("insertHTML", false, text);
				});
		</script>
	</body>
</html>
